graph TB
    subgraph External["ğŸŒ External Systems"]
        GH["GitHub Actions<br/>ğŸ”„ CI/CD Pipeline<br/>â€¢ Build Docker Image<br/>â€¢ Trivy Security Scan<br/>â€¢ Push to Docker Hub"]
        DH["Docker Hub<br/>ğŸ“¦ Container Registry<br/>vendettaopppp/ml-inference-service"]
        Dev["ğŸ‘¨â€ğŸ’» Developer<br/>kubectl CLI"]
    end

    subgraph K8s["â˜¸ï¸ Kubernetes Cluster (Kind - Local)"]
        subgraph Mon["ğŸ“Š monitoring namespace"]
            Prom["Prometheus<br/>ğŸ“ˆ Metrics Collection<br/>â€¢ Scrapes every 30s<br/>â€¢ Stores time-series data<br/>â€¢ Evaluates 6 alert rules"]
            Graf["Grafana<br/>ğŸ“‰ Dashboard<br/>â€¢ 8 visualization panels<br/>â€¢ Real-time metrics<br/>:30080"]
            AM["AlertManager<br/>ğŸ”” Notifications<br/>â€¢ Alert routing<br/>â€¢ Silencing"]
        end

        subgraph TenantA["ğŸ”µ tenant-a namespace"]
            HPA_A["HPA<br/>âš¡ Autoscaling<br/>2-10 pods<br/>Target: 50% CPU"]
            Deploy_A["Deployment<br/>ğŸš€ ML Inference<br/>FastAPI + Scikit-learn<br/>Sentiment Analysis"]
            Svc_A["Service<br/>ğŸŒ ClusterIP<br/>Port: 8000"]
            RBAC_A["ğŸ”’ Security<br/>â€¢ RBAC Role<br/>â€¢ ServiceAccount<br/>â€¢ NetworkPolicy"]
        end

        subgraph TenantB["ğŸ”´ tenant-b namespace"]
            HPA_B["HPA<br/>âš¡ Autoscaling<br/>2-10 pods<br/>Target: 50% CPU"]
            Deploy_B["Deployment<br/>ğŸš€ ML Inference<br/>FastAPI + Scikit-learn<br/>Sentiment Analysis"]
            Svc_B["Service<br/>ğŸŒ ClusterIP<br/>Port: 8000"]
            RBAC_B["ğŸ”’ Security<br/>â€¢ RBAC Role<br/>â€¢ ServiceAccount<br/>â€¢ NetworkPolicy"]
        end

        subgraph Storage["ğŸ’¾ minio namespace"]
            MinIO["MinIO<br/>ğŸ—„ï¸ Object Storage<br/>S3-Compatible<br/>â€¢ Models<br/>â€¢ Datasets<br/>â€¢ Artifacts"]
        end

        MS["Metrics Server<br/>ğŸ“Š Resource Metrics<br/>CPU/Memory Collection"]
    end

    Dev -->|kubectl port-forward| K8s
    GH -->|build + scan + push| DH
    DH -->|pull image| K8s

    Prom -->|scrape /metrics| Deploy_A
    Prom -->|scrape /metrics| Deploy_B
    Prom --> Graf
    Prom --> AM

    HPA_A -->|scale deployment| Deploy_A
    HPA_B -->|scale deployment| Deploy_B
    MS -->|provide metrics| HPA_A
    MS -->|provide metrics| HPA_B

    Deploy_A --> Svc_A
    Deploy_B --> Svc_B

    Deploy_A -.âŒ blocked by NetworkPolicy.-> Deploy_B

    RBAC_A -.protects.-> Deploy_A
    RBAC_B -.protects.-> Deploy_B

    style Mon fill:#e1f5e1,stroke:#2d5016,stroke-width:3px
    style TenantA fill:#e1e5f5,stroke:#162850,stroke-width:3px
    style TenantB fill:#f5e1e1,stroke:#501616,stroke-width:3px
    style Storage fill:#f5f5e1,stroke:#505016,stroke-width:3px
    style External fill:#f0f0f0,stroke:#404040,stroke-width:3px
    
    style Prom fill:#90EE90
    style Graf fill:#87CEEB
    style Deploy_A fill:#B0C4DE
    style Deploy_B fill:#FFB6C1
    style MinIO fill:#FFD700
    style GH fill:#D3D3D3

